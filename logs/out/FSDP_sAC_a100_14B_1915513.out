idr_torch is not installed, but its OK !! :)
>>> Training on 64 processes
world size:64, GBS:128, BSperDev:2, seq. length:4096, sAC ratio:1/2, grad accumulation:1, compile:True
Time to load and initialize the model and its tokenizer: 4.474s
Time to shard the model: 223.107s
Time to transfer the model to GPU: 0.061s
Time to instantiate torch.compile: 0.059s
number of parameters: 14770033664
Pre-loop Model MaxMemory for GPU:0 6.660595893859863 GBytes
Time to load dataset and initialize dataloader: 10.936s
global batch size: 128 - mini batch size: 2
DATALOADER 4 True True True 3 False 
Optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: True
    differentiable: False
    eps: 1e-05
    foreach: None
    fused: None
    lr: 1e-05
    maximize: False
    weight_decay: 0.1
)
Step 10 / 100 | Loss: 0.434 | Perplexity: 938176086016.000 | LR: 6.139e-08 | Wall: 441.619
Step 20 / 100 | Loss: 0.432 | Perplexity: 904870232064.000 | LR: 1.296e-07 | Wall: 372.225
Step 30 / 100 | Loss: 0.431 | Perplexity: 939185864704.000 | LR: 1.978e-07 | Wall: 372.372
Step 40 / 100 | Loss: 0.420 | Perplexity: 812541870080.000 | LR: 2.660e-07 | Wall: 372.343
Step 50 / 100 | Loss: 0.418 | Perplexity: 724074954752.000 | LR: 3.342e-07 | Wall: 372.184
Step 60 / 100 | Loss: 0.404 | Perplexity: 580156129280.000 | LR: 4.025e-07 | Wall: 372.280
Step 70 / 100 | Loss: 0.391 | Perplexity: 450807726080.000 | LR: 4.707e-07 | Wall: 372.213
Step 80 / 100 | Loss: 0.359 | Perplexity: 291161604096.000 | LR: 5.389e-07 | Wall: 372.436
Step 90 / 100 | Loss: 0.333 | Perplexity: 172030787584.000 | LR: 6.071e-07 | Wall: 372.277
Step 100 / 100 | Loss: 0.304 | Perplexity: 99999416320.000 | LR: 6.753e-07 | Wall: 428.547
>>> Training complete in: 1:04:32.966314
>>> Training performance time: min 24.393736839294434 avg 36.37242739128344 seconds (+/- 7.031778188981662)
>>> Forward performance time: min 9.612088203430176 avg 21.573824256357522 seconds (+/- 0.00016034586267650605)
>>> Backward performance time: min 14.747874975204468 avg 14.798600440073495 seconds (+/- 0.00016034586267650605)
>>> Loading performance time: min 0.0002770423889160156 avg 0.0004656338932538273 seconds (+/- 0.00016034586267650605)
>>> ########## BENCHMARKING #####################################
(Measured on 100 steps) Step time Avg : 37.22082710266113 s
Estimated Training Time (2 epochs bs 128) : 151.7369051551819 h
MaxMemory for GPU:0 48.585026264190674 GBytes
RANK: 0
VmPeak:  285817844 kB  VmHWM:  8985268 kB
NCCL version 2.27.3+cuda12.9
Sun Nov 23 03:05:06 PM CET 2025

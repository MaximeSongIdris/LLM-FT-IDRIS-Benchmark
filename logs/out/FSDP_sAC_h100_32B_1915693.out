idr_torch is not installed, but its OK !! :)
>>> Training on 64 processes
world size:64, GBS:128, BSperDev:2, seq. length:4096, sAC ratio:3/4, grad accumulation:1, compile:True
Time to load and initialize the model and its tokenizer: 4.342s
Time to shard the model: 589.868s
Time to transfer the model to GPU: 0.057s
Time to instantiate torch.compile: 0.065s
number of parameters: 32763876352
Pre-loop Model MaxMemory for GPU:0 7.7079973220825195 GBytes
Time to load dataset and initialize dataloader: 50.513s
global batch size: 128 - mini batch size: 2
DATALOADER 4 True True True 3 False 
Optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    decoupled_weight_decay: True
    differentiable: False
    eps: 1e-05
    foreach: None
    fused: None
    lr: 1e-05
    maximize: False
    weight_decay: 0.1
)
Step 10 / 100 | Loss: 0.404 | Perplexity: 154059227136.000 | LR: 6.139e-08 | Wall: 481.319
Step 20 / 100 | Loss: 0.404 | Perplexity: 155477032960.000 | LR: 1.296e-07 | Wall: 252.883
Step 30 / 100 | Loss: 0.403 | Perplexity: 156728164352.000 | LR: 1.978e-07 | Wall: 427.371
Step 40 / 100 | Loss: 0.396 | Perplexity: 139676893184.000 | LR: 2.660e-07 | Wall: 42.836
Step 50 / 100 | Loss: 0.395 | Perplexity: 130415116288.000 | LR: 3.342e-07 | Wall: 43.548
Step 60 / 100 | Loss: 0.386 | Perplexity: 114931900416.000 | LR: 4.025e-07 | Wall: 42.550
Step 70 / 100 | Loss: 0.381 | Perplexity: 100311744512.000 | LR: 4.707e-07 | Wall: 43.635
Step 80 / 100 | Loss: 0.363 | Perplexity: 78758576128.000 | LR: 5.389e-07 | Wall: 43.277
Step 90 / 100 | Loss: 0.347 | Perplexity: 58468487168.000 | LR: 6.071e-07 | Wall: 43.080
Step 100 / 100 | Loss: 0.328 | Perplexity: 42458226688.000 | LR: 6.753e-07 | Wall: 42.969
>>> Training complete in: 0:24:27.225837
>>> Training performance time: min 3.5701749324798584 avg 10.241385062535604 seconds (+/- 43.59311936381128)
>>> Forward performance time: min 1.1076164245605469 avg 7.687653580097237 seconds (+/- 0.00011834588246412523)
>>> Backward performance time: min 2.4379220008850098 avg 2.5537283926299126 seconds (+/- 0.00011834588246412523)
>>> Loading performance time: min 0.0002503395080566406 avg 0.0004123340953480114 seconds (+/- 0.00011834588246412523)
>>> ########## BENCHMARKING #####################################
(Measured on 100 steps) Step time Avg : 4.1665589809417725 s
Estimated Training Time (2 epochs bs 128) : 16.98567211230596 h
MaxMemory for GPU:0 54.45316743850708 GBytes
RANK: 0
VmPeak:  288613480 kB  VmHWM:  10314912 kB
NCCL version 2.27.3+cuda12.9
Sun Nov 23 15:29:57 CET 2025
